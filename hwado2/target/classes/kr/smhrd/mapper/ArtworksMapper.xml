<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.smhrd.mapper.ArtworksMapper">
<insert id="artRegi" parameterType="kr.smhrd.entity.Artworks">
insert into ARTWORKS (user_email, category_seq, aw_name, aw_price, aw_type) values (#{user_email}, #{category_seq}, #{aw_name}, #{aw_price}, #{aw_type})
</insert>

<select id="getAwSeq" parameterType="kr.smhrd.entity.Artworks" resultType="int">
select aw_seq from ARTWORKS where user_email=#{user_email} and category_seq=#{category_seq} and aw_name=#{aw_name} and aw_price=#{aw_price} and aw_type = #{aw_type}
</select>

<insert id="imgRegi" parameterType="kr.smhrd.entity.IMAGES">
insert into IMAGES (aw_seq, img_filename, img_rgb, img_type, aw_desc) values (#{aw_seq}, #{img_filename}, #{img_rgb}, #{img_type}, #{aw_desc})
</insert>

<insert id="auctionRegi" parameterType="kr.smhrd.entity.AUCTIONS">
insert into AUCTIONS (aw_seq, auc_ended_at) values (#{aw_seq}, #{auc_ended_at})
</insert>

<update id="auctionUpdate" parameterType="int">
update ARTWORKS set aw_status='경매' where aw_seq = #{aw_seq}
</update>

<select id="getimges" parameterType="kr.smhrd.entity.Artworks" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where aw_seq = #{aw_seq}
</select>

<select id="artList" resultType="kr.smhrd.entity.Artworks">
select * from ARTWORKS where aw_type='일반'
</select>

<select id="imgList" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where img_type='0' and aw_seq in (select aw_seq from ARTWORKS where aw_type='일반')
</select>

<select id="artAllList" resultType="kr.smhrd.entity.Artworks">
select * from ARTWORKS
</select>

<select id="imgAllList" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where img_type='0'
</select>

<select id="getArt" parameterType="int"  resultType="kr.smhrd.entity.Artworks">
select * from ARTWORKS where aw_seq=#{aw_seq}
</select>

<select id="showImg" parameterType="int"  resultType="String">
select img_filename from IMAGES where aw_seq=#{aw_seq}
</select>

<select id="auctionList" resultType="kr.smhrd.entity.Artworks">
select * from ARTWORKS where aw_type='경매'
</select>

<select id="auctionImgList" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where img_type='0' and aw_seq in (select aw_seq from ARTWORKS where aw_type='경매')
</select>
<select id="auctioninfo" resultType="kr.smhrd.entity.AUCTIONS">
select * from AUCTIONS
</select>

<select id="getAuction" parameterType="int"  resultType="kr.smhrd.entity.AUCTIONS">
select * from AUCTIONS where aw_seq=#{aw_seq}
</select>

<select id="wishCheck" parameterType="kr.smhrd.entity.WISHLIST" resultType="int">
select count(*) from WISHLIST where user_email = #{user_email} and aw_seq = #{aw_seq}
</select>

<insert id="wishList" parameterType="kr.smhrd.entity.WISHLIST">
insert into WISHLIST (user_email, aw_seq) values (#{user_email}, #{aw_seq})
</insert>

<delete id="deleteWish" parameterType="kr.smhrd.entity.WISHLIST">
delete from WISHLIST  where user_email = #{user_email} and aw_seq = #{aw_seq} 
</delete>

<select id="getArtist" parameterType="String" resultType="kr.smhrd.entity.Users">
select * from USERS where user_email = #{user_email}
</select>


<select id="artworkList" resultType="kr.smhrd.entity.Artworks">
		select * from ARTWORKS where aw_status="심사대기"
	</select>

<select id="imgsList" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where img_type='0' and aw_seq in (select aw_seq from ARTWORKS where aw_status="심사대기")
</select>



<select id="getWishImg" parameterType="int" resultType="kr.smhrd.entity.IMAGES">
select * from IMAGES where img_type='0' and aw_seq = #{aw_seq}
</select>


<update id="approvalAw" parameterType="String">
		UPDATE ARTWORKS SET aw_status = "판매중" WHERE aw_seq=#{aw_seq}
	</update>

<update id="refuseAw" parameterType="String">
		UPDATE ARTWORKS SET aw_status = "판매거절" WHERE aw_seq=#{aw_seq}
	</update>





</mapper>